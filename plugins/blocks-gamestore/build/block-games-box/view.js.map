{"version":3,"file":"block-games-box/view.js","mappings":"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","sources":["webpack://blocks-gamestore/./src/block-games-box/view.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', function () {\n\n\tconst filterForm = document.querySelector('.gamestore-filter-form');\n\tconst sortingForm = document.querySelector('.gamestore-sorting-form');\n\tconst loadMoreButton = document.querySelector('.load-more-button');\n\tlet currentPage = 1;\n\n\tif (!filterForm && !sortingForm) return;\n\n\tfilterForm.addEventListener('change', function () {\n\t\tcurrentPage = 1;\n\t\tsubmitForm(false);\n\t});\n\n\tsortingForm.addEventListener('change', function () {\n\t\tcurrentPage = 1;\n\t\tsubmitForm(false);\n\t});\n\n\tfilterForm.addEventListener('change', function () {\n\t\tcurrentPage = 1;\n\t\tsubmitForm(false);\n\t});\n\n\tfilterForm.addEventListener('reset', function () {\n\t\tcurrentPage = 1;\n\t\tsetTimeout(() => submitForm(false), 0);\n\t});\n\n\tif (loadMoreButton) {\n\t\tloadMoreButton.addEventListener('click', function () {\n\t\t\tcurrentPage++;\n\t\t\tsetTimeout(() => {\n\t\t\t\tsubmitForm(true);\n\t\t\t}, 100)\n\t\t})\n\t}\n\n\tfunction submitForm(append = false) {\n\t\tconst formData = new FormData(filterForm);\n\t\tconst formSortingData = new FormData(sortingForm);\n\n\t\tconst selectedLanguages = [];\n\t\tfilterForm.querySelectorAll('input[name^=\"language-\"]:checked').forEach((checkbox) => {\n\t\t\tselectedLanguages.push(checkbox.name.replace('language-', ''));\n\t\t})\n\t\t// console.log(selectedLanguages) // ['29', '25', '26']\n\n\t\tconst selectedGenres = [];\n\t\tfilterForm.querySelectorAll('input[name^=\"genre-\"]:checked').forEach((checkbox) => {\n\t\t\tselectedGenres.push(checkbox.name.replace('genre-', ''));\n\t\t})\n\n\t\tconst releasedRaw = (formData.get('released') || '').trim();\n\t\tconst releasedYear = releasedRaw ? releasedRaw.slice(0, 4) : '';\n\n\t\tfetch(gamestore_params.ajaxurl, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'\n\t\t\t},\n\t\t\tbody: new URLSearchParams({\n\t\t\t\taction: 'filter_games',\n\t\t\t\tpage: currentPage,\n\t\t\t\tposts_per_page: formData.get('posts_per_page'),\n\t\t\t\tplatforms: formData.get('platforms') || '',\n\t\t\t\tpublisher: formData.get('publisher') || '',\n\t\t\t\tsingleplayer: formData.get('singleplayer') || '',\n\t\t\t\treleased: releasedYear,\n\t\t\t\tlanguages: selectedLanguages.join(','),\n\t\t\t\tgenres: selectedGenres.join(','),\n\t\t\t\tsort: formSortingData.get('sorting') // sorting - это name селекта в форме сортировки, который может быть 'latest', 'price_low_high', 'price_high_low', 'popularity'\n\t\t\t})\n\t\t})\n\t\t\t.then(response => response.text())\n\t\t\t.then(data => {\n\t\t\t\tconst gamesListContainer = document.querySelector('.games-list');\n\t\t\t\tif (append) { // если нужно добавить к существующему списку\n\t\t\t\t\tgamesListContainer.innerHTML += data;\n\t\t\t\t} else { // если нужно заменить список\n\t\t\t\t\tgamesListContainer.innerHTML = data;\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => console.error('Error', error));\n\t}\n});\n\n\n// Событие change на форме (и вообще в DOM) срабатывает не “у формы” как у отдельного поля, а всплывает (bubbles) от элементов управления внутри формы\n// То есть твой обработчик: filterForm.addEventListener('change', ...) сработает когда изменится значение любого инпута/селекта/textarea внутри этой формы, и это событие всплывёт до <form>\n// formData.append('page', currentPage); // Добавляем текущую страницу в данные формы, чтобы сервер знал, какую страницу запрашивать\n// new URLSearchParams(formData).toString(); // Преобразуем FormData в строку запроса (languages%5B%5D=29&genres%5B%5D=32&platform=36&singleplayer=Yes&publisher=Ubisoft&year=2026&posts_per_page=8&page=1)\n\n\n// javascript\n// Коротко: собираем FormData (включая поля с именами типа genres[]), добавляем action и страницу,\n// затем превращаем в URLSearchParams и отправляем POST body.\n"],"names":["document","addEventListener","filterForm","querySelector","sortingForm","loadMoreButton","currentPage","submitForm","setTimeout","append","formData","FormData","formSortingData","selectedLanguages","querySelectorAll","forEach","checkbox","push","name","replace","selectedGenres","releasedRaw","get","trim","releasedYear","slice","fetch","gamestore_params","ajaxurl","method","headers","body","URLSearchParams","action","page","posts_per_page","platforms","publisher","singleplayer","released","languages","join","genres","sort","then","response","text","data","gamesListContainer","innerHTML","catch","error","console"],"sourceRoot":""}